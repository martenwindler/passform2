// 1. ZUERST: Alle SASS-Dateien laden (Absolut oben!)
@use 'base/variables' as *;
@use 'base/fonts';
@use 'base/typography';
@use 'base/reset';

// Atome
@use 'atoms/button';
@use 'atoms/badge';
@use 'atoms/input';

// Moleküle
@use 'molecules/hardware-status';
@use 'molecules/rail-btn';
@use 'molecules/status-pill';

// Organismen
@use 'organisms/navbar';
@use 'organisms/sidebar';
@use 'organisms/modal';

// Sidebar-Tabs
@use 'organisms/sidebar/tabs/logs';
@use 'organisms/sidebar/tabs/planning';
@use 'organisms/sidebar/tabs/agents';
@use 'organisms/sidebar/tabs/hardware';

// Sidebar-Tabs-Sections
@use "organisms/sidebar/sections/planning-planer";
@use "organisms/sidebar/sections/planning-weights";
@use "organisms/sidebar/sections/planning-result";

// L to the ayouts
@use 'layouts/landinglayout';
@use 'layouts/mainlayout';

// 2. DANACH: Tailwind Schichten injizieren
@tailwind base;
@tailwind components;
@tailwind utilities;

* {
    box-sizing: border-box; 
}

// 3. ZULETZT: Deine globalen Layout-Klassen
// Letzte Instanz: Alles innerhalb der App ist standardmäßig weiß
.app-layout {
    @apply text-white;
    color: white !important;
}

// Sicherstellen, dass die Sidebar keine schwarzen Texte erlaubt
.sidebar-container {
    @apply text-white;
    color: white !important;
}

// 2. Global Fixes
* {
    box-sizing: border-box; 
}

.app-layout {
    @apply text-white flex flex-col h-screen w-screen overflow-hidden bg-bg-main;
}

// 3. Der Content-Bereich (Das Herzstück)
.content-area {
    @apply flex flex-1 flex-row overflow-hidden relative;
    // Wir nutzen Flexbox, weil flex: 1 am Gitter perfekt auf die Breite der Sidebar reagiert
}

.grid-viewport {
    // flex-1 sorgt dafür, dass dieser Bereich den restlichen Platz einnimmt
    @apply h-full relative flex-1;
    
    // min-width: 0 ist KRITISCH, damit Flexbox den Bereich schmaler machen darf
    min-width: 0; 
    overflow: hidden;

    // Sanfter Übergang, wenn die Sidebar den Platz beansprucht
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);

    three-grid-scene {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
}

// 4. Sidebar Integration (Zustandskontrolle)
.sidebar-container {
    // Die Sidebar behält ihre eigene Breiten-Animation (aus der sidebar.scss)
    // Da sie im selben Flex-Container wie .grid-viewport sitzt,
    // "drückt" sie das Gitter automatisch nach links.
    @apply h-full shrink-0;
}

// Globales Schrift-Setup
body {
    // Standard-Font über Tailwind-Variable (Open Sans aus deiner Config)
    @apply font-sans antialiased; 
    
    // Glättung für helle Schrift auf dunklem Grund
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    
    // Die Basisgröße (0.875rem = 14px bei 16px Basis)
    // Das ist etwas lesbarer als 13px, aber immer noch kompakt
    font-size: 0.875rem; 
    line-height: 1.5;
    color: theme('colors.text-main');
}

// Form-Elemente erben die Schriftfamilie automatisch
input, button, textarea, select {
    font-family: inherit;
    font-size: inherit;
}

// Spezialfall: Tabellen oder kleine Labels (wie in der Sidebar)
.text-micro {
    font-size: 0.75rem; // 12px
    @apply font-medium tracking-wide uppercase;
}

.loading-overlay {
    @apply absolute inset-0 flex items-center justify-center pointer-events-none opacity-0 transition-opacity duration-200;
    z-index: 10;
    
    &.is-loading { opacity: 1; }
    
    svg {
        @apply w-12 h-12 animate-spin text-info;
    }
}

.sidebar-container, .modal-content {
    backdrop-filter: blur(12px); // Erhöhter Wert für den "Frosted Glass" Look
    background-color: rgba(26, 32, 44, 0.8); // Dein bg-dark mit 80% Deckkraft
}